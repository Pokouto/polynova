{% extends "base.html" %}
{% block content %}
<div class="max-w-7xl mx-auto py-10 px-4 sm:px-6 lg:px-8">
    <div class="md:flex md:items-center md:justify-between mb-8"><div class="flex-1 min-w-0"><h2 class="text-2xl font-bold leading-7 text-gray-900 sm:text-3xl sm:truncate">Mon Espace Enseignant</h2></div><div class="mt-4 flex md:mt-0 md:ml-4 items-center gap-4">{% if profile.status == 'validated' %}<span class="px-3 py-1 rounded-full text-sm font-medium bg-green-100 text-green-800">üü¢ Valid√©</span>{% else %}<span class="px-3 py-1 rounded-full text-sm font-medium bg-yellow-100 text-yellow-800">üü† En attente</span>{% endif %}<button onclick="toggleEditMode()" id="editBtn" class="bg-blue-600 text-white px-4 py-2 rounded-md shadow-sm text-sm"><i class="fas fa-edit mr-2"></i> Modifier mon profil</button><button onclick="toggleEditMode()" id="cancelBtn" class="hidden bg-gray-200 text-gray-700 px-4 py-2 rounded-md text-sm hover:bg-gray-300">Annuler</button></div></div>
    <div class="grid grid-cols-1 gap-6 lg:grid-cols-3">
        <div class="lg:col-span-2">
            <div id="viewMode" class="bg-white shadow sm:rounded-lg overflow-hidden">
                <div class="px-6 py-6 border-b border-gray-100 flex items-center gap-6">{% if profile.photo %}<img src="{{ profile.photo.url }}" class="w-24 h-24 rounded-full object-cover border-4 border-gray-50">{% else %}<div class="w-24 h-24 rounded-full bg-gray-100 flex items-center justify-center text-3xl">üéì</div>{% endif %}<div><h3 class="text-xl font-bold text-gray-900">{{ user.first_name }} {{ user.last_name }}</h3><p class="text-gray-500">{{ user.email }} ‚Ä¢ {{ user.phone }}</p>{% if profile.city %}<p class="text-sm text-blue-600 mt-1"><i class="fas fa-map-marker-alt"></i> {{ profile.city.name }} - {{ profile.quartier }}</p>{% endif %}</div></div>
                <div class="px-6 py-6 border-b border-gray-100"><h4 class="text-sm font-bold text-gray-500 uppercase mb-2">Ma Biographie</h4><p class="text-gray-700 whitespace-pre-line">{{ profile.bio|default:"Aucune description renseign√©e." }}</p></div>
                <div class="px-6 py-6 border-b border-gray-100"><h4 class="text-sm font-bold text-gray-500 uppercase mb-3">Mati√®res & Niveaux</h4><div class="flex flex-wrap gap-2 mb-3">{% for sub in profile.subjects.all %}<span class="bg-blue-50 text-blue-700 px-2 py-1 rounded text-sm">{{ sub.name }}</span>{% endfor %}</div><div class="flex flex-wrap gap-2">{% for lvl in profile.levels.all %}<span class="bg-gray-100 text-gray-700 px-2 py-1 rounded text-sm">{{ lvl.name }}</span>{% endfor %}</div></div>
            </div>
            <div id="editMode" class="hidden bg-white shadow sm:rounded-lg"><div class="px-4 py-5 sm:p-6"><h3 class="text-lg leading-6 font-medium text-gray-900 mb-4 border-b pb-2">Modification du profil</h3><form method="POST" enctype="multipart/form-data" class="space-y-6">{% csrf_token %}<div class="bg-blue-50 p-4 rounded-md border border-blue-100"><h4 class="text-sm font-bold text-blue-800 uppercase mb-3">Connexion</h4><div class="grid grid-cols-1 gap-4 sm:grid-cols-2"><div><label class="text-sm font-medium">Nom</label>{{ u_form.last_name }}</div><div><label class="text-sm font-medium">Pr√©nom</label>{{ u_form.first_name }}</div><div><label class="text-sm font-medium">Email</label>{{ u_form.email }}</div><div><label class="text-sm font-medium">T√©l√©phone</label>{{ u_form.phone }}</div></div></div><div><label class="block text-sm font-medium">Biographie</label>{{ p_form.bio }}</div><div><label class="block text-sm font-medium">Photo</label>{{ p_form.photo }}</div><div class="grid grid-cols-1 gap-4 sm:grid-cols-2"><div><label class="block text-sm font-medium">Ville</label>{{ p_form.city }}</div><div><label class="block text-sm font-medium">Quartier</label>{{ p_form.quartier }}</div></div><div class="border-t pt-4"><h4 class="text-sm font-bold text-gray-700 mb-3">P√©dagogie</h4><div class="grid grid-cols-1 md:grid-cols-2 gap-4"><div><label class="text-sm">Mati√®res</label><div class="h-32 overflow-y-auto border rounded p-2">{{ p_form.subjects }}</div></div><div><label class="text-sm">Niveaux</label><div class="h-32 overflow-y-auto border rounded p-2">{{ p_form.levels }}</div></div></div><div class="mt-3 flex gap-4"><div class="flex items-center">{{ p_form.is_home_class }} <span class="ml-2 text-sm">Domicile</span></div><div class="flex items-center">{{ p_form.is_online_class }} <span class="ml-2 text-sm">En ligne</span></div></div></div><div class="border-t pt-4 bg-gray-50 p-3 rounded"><h4 class="text-sm font-bold text-gray-700 mb-3">Mise √† jour documents</h4><div class="grid gap-3 text-sm"><div>CNI: {{ p_form.cni_document }}</div><div>Casier: {{ p_form.casier_judiciaire }}</div><div>Dipl√¥mes: {{ p_form.diplomes_file }}</div></div></div><button type="submit" class="w-full bg-blue-600 text-white py-2 rounded-md shadow-lg hover:bg-blue-700">Enregistrer les modifications</button></form></div></div>
        </div>
        <div class="lg:col-span-1 space-y-6"><div class="bg-white shadow rounded-lg p-6 text-center"><h4 class="font-bold text-gray-900">Mon Statut</h4><div class="mt-4 text-3xl font-bold {% if profile.status == 'validated' %}text-green-600{% else %}text-orange-500{% endif %}">{% if profile.status == 'validated' %}100%{% else %}40%{% endif %}</div><p class="text-sm text-gray-500 mt-1">Compl√©tude du profil</p></div>{% if profile.admin_notes %}<div class="bg-red-50 border border-red-200 p-4 rounded-lg"><h4 class="text-red-800 font-bold text-sm">Message Admin</h4><p class="text-red-600 text-sm mt-1">{{ profile.admin_notes }}</p></div>{% endif %}</div>
    </div>
</div>
<script>function toggleEditMode() { const view = document.getElementById('viewMode'); const edit = document.getElementById('editMode'); const editBtn = document.getElementById('editBtn'); const cancelBtn = document.getElementById('cancelBtn'); if (edit.classList.contains('hidden')) { view.classList.add('hidden'); edit.classList.remove('hidden'); editBtn.classList.add('hidden'); cancelBtn.classList.remove('hidden'); } else { view.classList.remove('hidden'); edit.classList.add('hidden'); editBtn.classList.remove('hidden'); cancelBtn.classList.add('hidden'); } }</script>
{% endblock %}